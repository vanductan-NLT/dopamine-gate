"use strict";(()=>{var l={BLOCKLIST:"blocklist",API_KEY:"apiKey",LOGS:"logs"},m=["facebook.com","tiktok.com","twitter.com","instagram.com","youtube.com","reddit.com"];async function g(t){return new Promise(e=>{chrome.storage.sync.get(t,o=>{e(o)})})}async function r(){return(await g([l.BLOCKLIST])).blocklist??m}function s(t,e){try{let i=new URL(t).hostname.toLowerCase();return e.some(c=>{let n=c.toLowerCase();return i===n||i.endsWith("."+n)})}catch{return!1}}async function a(t,e){if(e&&!(e.startsWith("chrome://")||e.startsWith("chrome-extension://")))try{let o=await r();s(e,o)&&(console.log(`[Dopamine Gate] Blocked domain detected: ${e}`),await chrome.scripting.insertCSS({target:{tabId:t},files:["overlay.css"]}),await chrome.scripting.executeScript({target:{tabId:t},files:["contentScript.js"]}))}catch(o){let i=o instanceof Error?o.message:String(o);console.debug("[Dopamine Gate] Navigation noise:",i)}}chrome.webNavigation.onCommitted.addListener(t=>{t.frameId===0&&a(t.tabId,t.url)});chrome.tabs.onUpdated.addListener((t,e,o)=>{e.url&&a(t,e.url)});chrome.runtime.onMessage.addListener((t,e,o)=>{var i;return t.type==="CLOSE_TAB"&&((i=e.tab)!=null&&i.id&&chrome.tabs.remove(e.tab.id),o({success:!0})),!0});chrome.runtime.onInstalled.addListener(t=>{t.reason==="install"?console.log("[Dopamine Gate] Extension installed successfully!"):t.reason==="update"&&console.log(`[Dopamine Gate] Updated to version ${chrome.runtime.getManifest().version}`)});console.log("[Dopamine Gate] Background service worker started");})();
//# sourceMappingURL=background.js.map

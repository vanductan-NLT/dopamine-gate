"use strict";(()=>{var m={BLOCKLIST:"blocklist",API_KEY:"apiKey",LOGS:"logs",IS_ENABLED:"isEnabled"},O=["facebook.com","tiktok.com","twitter.com","instagram.com","youtube.com","reddit.com"];async function u(t){return new Promise(e=>{chrome.storage.sync.get(t,s=>{e(s)})})}async function c(t){return new Promise(e=>{chrome.storage.sync.set(t,e)})}async function g(){return(await u([m.BLOCKLIST])).blocklist??O}async function P(t){let e=await g(),s=A(t);e.includes(s)||(e.push(s),await c({blocklist:e}))}async function I(t){let e=await g(),s=A(t),n=e.filter(a=>a!==s);await c({blocklist:n})}function A(t){return t.toLowerCase().replace(/^https?:\/\//,"").replace(/^www\./,"").replace(/\/.*$/,"").trim()}async function S(){return(await u([m.API_KEY])).apiKey??""}async function D(t){await c({apiKey:t.trim()})}async function x(){return(await u([m.LOGS])).logs??[]}async function B(){await c({logs:[]})}async function M(){return(await u([m.IS_ENABLED])).isEnabled!==!1}async function T(t){await c({isEnabled:t})}var K=document.querySelectorAll(".tab-btn"),H=document.querySelectorAll(".tab-content"),i=document.getElementById("new-domain"),w=document.getElementById("btn-add-domain"),E=document.getElementById("domain-list"),o=document.getElementById("api-key"),l=document.getElementById("btn-toggle-key"),v=document.getElementById("btn-save-key"),y=document.getElementById("api-key-status"),L=document.getElementById("btn-clear-logs"),h=document.getElementById("logs-list"),k=document.getElementById("logs-empty"),r=document.getElementById("extension-toggle");K.forEach(t=>{t.addEventListener("click",()=>{var s;let e=t.getAttribute("data-tab");K.forEach(n=>n.classList.remove("active")),t.classList.add("active"),H.forEach(n=>n.classList.remove("active")),(s=document.getElementById(`panel-${e}`))==null||s.classList.add("active"),e==="logs"&&$()})});async function b(){let t=await g();E&&(E.innerHTML=t.map(e=>`
      <li class="domain-item">
        <span class="domain-name">${p(e)}</span>
        <button class="btn-remove" data-domain="${p(e)}" title="Remove">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
        </button>
      </li>
    `).join(""),E.querySelectorAll(".btn-remove").forEach(e=>{e.addEventListener("click",async s=>{let n=e.getAttribute("data-domain");n&&(await I(n),await b())})}))}async function C(){let t=i==null?void 0:i.value.trim();t&&(await P(t),i.value="",await b())}w==null||w.addEventListener("click",C);i==null||i.addEventListener("keypress",t=>{t.key==="Enter"&&C()});async function z(){let t=await S();o&&t&&(o.value=t,f("API configuration active","success"))}l==null||l.addEventListener("click",()=>{if(o){let t=o.type==="password";o.type=t?"text":"password",l&&(l.innerHTML=t?'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>':'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>')}});v==null||v.addEventListener("click",async()=>{let t=o==null?void 0:o.value.trim();if(!t){f("Please enter an API key","error");return}if(!t.startsWith("AIza")){f("Invalid key format (should start with AIza...)","error");return}await D(t),f("API configuration saved successfully","success")});function f(t,e){y&&(y.textContent=t,y.className=`status-message ${e}`,setTimeout(()=>{y.className="status-message"},3e3))}async function $(){let t=await x();if(!(!h||!k)){if(t.length===0){h.innerHTML="",k.style.display="block";return}k.style.display="none",h.innerHTML=t.map(e=>{let s=new Date(e.timestamp),n=j(s),a=e.aiDecision.decision,d=e.aiDecision.decision==="allow"?"ALLOWED":"BLOCKED";return`
        <div class="log-item">
          <div class="log-meta">
            <span class="log-domain">${p(e.domain)}</span>
            <span>${n}</span>
          </div>
          <p class="log-message">
            <span class="log-status ${a}">${d}</span>: 
            ${p(e.aiDecision.message)}
          </p>
        </div>
      `}).join("")}}L==null||L.addEventListener("click",async()=>{confirm("Are you sure you want to clear your reflection history?")&&(await B(),await $())});async function _(){let t=await M();r&&(r.checked=t)}r==null||r.addEventListener("change",async()=>{let t=r.checked;await T(t)});function p(t){let e=document.createElement("div");return e.textContent=t,e.innerHTML}function j(t){let s=new Date().getTime()-t.getTime(),n=Math.floor(s/6e4),a=Math.floor(s/36e5),d=Math.floor(s/864e5);return n<1?"Just now":n<60?`${n}m ago`:a<24?`${a}h ago`:d<7?`${d}d ago`:t.toLocaleDateString("en-US")}async function G(){await b(),await z(),await _()}G();})();
//# sourceMappingURL=popup.js.map

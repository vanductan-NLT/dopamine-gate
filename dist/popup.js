"use strict";(()=>{var y={BLOCKLIST:"blocklist",API_KEY:"apiKey",LOGS:"logs"},K=["facebook.com","tiktok.com","twitter.com","instagram.com","youtube.com","reddit.com"];async function f(t){return new Promise(e=>{chrome.storage.sync.get(t,o=>{e(o)})})}async function l(t){return new Promise(e=>{chrome.storage.sync.set(t,e)})}async function m(){return(await f([y.BLOCKLIST])).blocklist??K}async function P(t){let e=await m(),o=A(t);e.includes(o)||(e.push(o),await l({blocklist:e}))}async function b(t){let e=await m(),o=A(t),s=e.filter(a=>a!==o);await l({blocklist:s})}function A(t){return t.toLowerCase().replace(/^https?:\/\//,"").replace(/^www\./,"").replace(/\/.*$/,"").trim()}async function D(){return(await f([y.API_KEY])).apiKey??""}async function S(t){await l({apiKey:t.trim()})}async function I(){return(await f([y.LOGS])).logs??[]}async function x(){await l({logs:[]})}var T=document.querySelectorAll(".tab-btn"),C=document.querySelectorAll(".tab-content"),i=document.getElementById("new-domain"),p=document.getElementById("btn-add-domain"),v=document.getElementById("domain-list"),n=document.getElementById("api-key"),r=document.getElementById("btn-toggle-key"),w=document.getElementById("btn-save-key"),d=document.getElementById("api-key-status"),L=document.getElementById("btn-clear-logs"),h=document.getElementById("logs-list"),k=document.getElementById("logs-empty");T.forEach(t=>{t.addEventListener("click",()=>{var o;let e=t.getAttribute("data-tab");T.forEach(s=>s.classList.remove("active")),t.classList.add("active"),C.forEach(s=>s.classList.remove("active")),(o=document.getElementById(`panel-${e}`))==null||o.classList.add("active"),e==="logs"&&M()})});async function E(){let t=await m();v&&(v.innerHTML=t.map(e=>`
      <li class="domain-item">
        <span class="domain-name">${g(e)}</span>
        <button class="btn-remove" data-domain="${g(e)}" title="Remove">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
        </button>
      </li>
    `).join(""),v.querySelectorAll(".btn-remove").forEach(e=>{e.addEventListener("click",async o=>{let s=e.getAttribute("data-domain");s&&(await b(s),await E())})}))}async function B(){let t=i==null?void 0:i.value.trim();t&&(await P(t),i.value="",await E())}p==null||p.addEventListener("click",B);i==null||i.addEventListener("keypress",t=>{t.key==="Enter"&&B()});async function $(){let t=await D();n&&t&&(n.value=t,u("API configuration active","success"))}r==null||r.addEventListener("click",()=>{if(n){let t=n.type==="password";n.type=t?"text":"password",r&&(r.innerHTML=t?'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>':'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>')}});w==null||w.addEventListener("click",async()=>{let t=n==null?void 0:n.value.trim();if(!t){u("Please enter an API key","error");return}if(!t.startsWith("AIza")){u("Invalid key format (should start with AIza...)","error");return}await S(t),u("API configuration saved successfully","success")});function u(t,e){d&&(d.textContent=t,d.className=`status-message ${e}`,setTimeout(()=>{d.className="status-message"},3e3))}async function M(){let t=await I();if(!(!h||!k)){if(t.length===0){h.innerHTML="",k.style.display="block";return}k.style.display="none",h.innerHTML=t.map(e=>{let o=new Date(e.timestamp),s=O(o),a=e.aiDecision.decision,c=e.aiDecision.decision==="allow"?"ALLOWED":"BLOCKED";return`
        <div class="log-item">
          <div class="log-meta">
            <span class="log-domain">${g(e.domain)}</span>
            <span>${s}</span>
          </div>
          <p class="log-message">
            <span class="log-status ${a}">${c}</span>: 
            ${g(e.aiDecision.message)}
          </p>
        </div>
      `}).join("")}}L==null||L.addEventListener("click",async()=>{confirm("Are you sure you want to clear your reflection history?")&&(await x(),await M())});function g(t){let e=document.createElement("div");return e.textContent=t,e.innerHTML}function O(t){let o=new Date().getTime()-t.getTime(),s=Math.floor(o/6e4),a=Math.floor(o/36e5),c=Math.floor(o/864e5);return s<1?"Just now":s<60?`${s}m ago`:a<24?`${a}h ago`:c<7?`${c}d ago`:t.toLocaleDateString("en-US")}async function H(){await E(),await $()}H();})();
//# sourceMappingURL=popup.js.map
